---
// index.astro (or any other page)

import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import SelectedFeaturedCards from '../components/SelectedFeaturedCards.astro';
import { FRONTPAGE_QUERY } from '../queries/frontpage';
import { fetchGraphQL } from '../utils/fetch-graphql';

// Fetch data
const data = await fetchGraphQL(FRONTPAGE_QUERY);

// Destructure front page content
const [hero, , selectedFeatureCards, bottom] = data.frontPage.content;

// Prepare hero and bottom data
const heroTopData = {
	title: hero.heading.value,
	subtitle: hero.eyebrow,
	ctaText: 'Learn More',
	ctaLink: `/${hero.link.slug}`,
	headingClassName: 'h5',
	heroAlign: hero.heroAlign,
};

const bottomData = {
	title: bottom.heading.value,
	subtitle: bottom.eyebrow,
	ctaText: 'Let\'s Talk',
	ctaLink: `/${bottom.link.slug}`,
	headingLevel: 'h2',
	headingClassName: 'h5',
	heroAlign: bottom.heroAlign,
};

// Destructure data for SelectedFeaturedCards
const { 
	callout: [{ 
	heading: { value: headline }, 
	content: { value: content }, 
	link: { slug: linkUrl } 
	}], 
	articles 
} = selectedFeatureCards;

const linkText = "Learn More";
---

<BaseLayout>
	<Hero heroData={heroTopData} className={hero?.heroAlign} />
	<SelectedFeaturedCards
		headline={headline}
		content={content}
		linkText={linkText}
		linkUrl={`/${linkUrl}`}
		articles={articles}
	/>
	<Hero heroData={bottomData} className={`secondary ${bottom?.heroAlign}`} />
</BaseLayout>